<script language="javascript">
var timer;
var flag = new Array(100);
var existingnum = new Array(100);
var clickTimes = 0;
var randnum;
var cellnum =1;
var mobile = new Array();

<% @users.each_with_index do |user, index| %>
mobile[<%= index %>] = "<%= user.mobile %> , <%= user.name %>";
<% end %>

var num = mobile.length-1;
function getRandNum(){
num=parseInt(num);
var y=GetRnd(0,num);
document.getElementById("result").value = mobile[y];
}
function start(){
clearInterval(timer);
timer = setInterval('change()',50);
}
function ok(){
clearInterval(timer);
}
function GetRnd(m,n){
randnum =parseInt(Math.random()*(n-m+1));
return randnum;
}
function setTimer(){
 time=setInterval("getRandNum()",10);
 document.getElementById("start").disabled = true;
 document.getElementById("end").disabled = false;
}
function clearTimer(){
 noDupNum();
 clearInterval(time);
 document.getElementById("start").disabled = false;
 document.getElementById("end").disabled = true;
 setValues();
}
function noDupNum(){
 mobile.removeEleAt(randnum);
 var o = 0;
 for(p=0; p<mobile.length;p++){
 if(typeof mobile[p]!="undefined"){
 mobile[o] = mobile[p];
 o++;
 }
 }
 num = mobile.length-1;
 }

Array.prototype.removeEleAt = function(dx)
 {
 if(isNaN(dx)||dx>this.length){return false;}
 this.splice(dx,1);
 }

function setValues(){
 document.getElementById(cellnum).value =
document.getElementById("result").value ;
 cellnum++;
 }
</script>
<center>
  <div> </div>
  <div id="main">
  <div>
  <h1>现在开始抽取WebEx彩蛋中奖者</h1>
  <p>
  <input type="text" style="font-size:60px;" id="result"
  style="height:130px;width:800px;border:2px solid
  red;" size="30" readonly/></p>
   <p>
   <input id="start" type="button" value="开始"
  style="border: 1px solid; border-color: #aaa 000
  #000 #aaa;width:4em; background: #fc0;"
  onclick="setTimer()" />
   <input id="end" type="button" value="停"
  style="border: 1px solid; border-color: #aaa 000
  #000 #aaa;width:4em; background:
  #fc0;"onclick="clearTimer()" disabled/>
  </p>
   <p>中奖者:</p>
   <table width="961" height="102" border="1">
     <tr>
   <td align="center"><input name="text1" type="text" id="1"
  style="height:30px;width:190px;border:1px solid
  red;font-size:25;" size="28" readonly/></td>
   </tr>
   </table>
   <p> </p>
   <p> </p>
   <p> </p>
   </div>
  </div>
<center>
